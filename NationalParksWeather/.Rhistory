states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
# ggplot(newState)+
#   geom_sf(data = newState)+
#   geom_point(data=PopularParks, aes(x=latitude, y =longitude))
#   theme_bw()
# pal <- colorNumeric(
#   c( "maroon","steelblue", "blue4","tan","grey","red","green","orange","purple","pink"),
#   domain = min(sizePark$Total_Visitor_Spending, na.rm = TRUE):max(sizePark$Total_Visitor_Spending, na.rm = TRUE))
pal <- colorFactor(
palette = c("red", "yellow", "green"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Latitude: ", latitude, "<br>Longitude: ", longitude,"<br>Total Visitor Spending: ", Total_Visitor_Spending),
radius = sizeParks$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )
library(USAboundaries)
library(sf)
library(leaflet)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
# ggplot(newState)+
#   geom_sf(data = newState)+
#   geom_point(data=PopularParks, aes(x=latitude, y =longitude))
#   theme_bw()
# pal <- colorNumeric(
#   c( "maroon","steelblue", "blue4","tan","grey","red","green","orange","purple","pink"),
#   domain = min(sizePark$Total_Visitor_Spending, na.rm = TRUE):max(sizePark$Total_Visitor_Spending, na.rm = TRUE))
pal <- colorFactor(
palette = c("red", "yellow", "green"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Latitude: ", latitude, "<br>Longitude: ", longitude,"<br>Total Visitor Spending: ", Total_Visitor_Spending),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )
# addCircleMarkers(data = st_as_sf(filter(CityPop, rank==3)),group = "three",color =~pal(rank),radius = 3, fillOpacity = 0.8,label=filter(CityPop, rank==3)$city
library(USAboundaries)
library(sf)
library(leaflet)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
# ggplot(newState)+
#   geom_sf(data = newState)+
#   geom_point(data=PopularParks, aes(x=latitude, y =longitude))
#   theme_bw()
# pal <- colorNumeric(
#   c( "maroon","steelblue", "blue4","tan","grey","red","green","orange","purple","pink"),
#   domain = min(sizePark$Total_Visitor_Spending, na.rm = TRUE):max(sizePark$Total_Visitor_Spending, na.rm = TRUE))
pal <- colorFactor(
palette = c("lightblue", "lightblue3","steelblue", "steelblue4","blue"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Latitude: ", latitude, "<br>Longitude: ", longitude,"<br>Total Visitor Spending: ", Total_Visitor_Spending),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )
# addCircleMarkers(data = st_as_sf(filter(CityPop, rank==3)),group = "three",color =~pal(rank),radius = 3, fillOpacity = 0.8,label=filter(CityPop, rank==3)$city
library(USAboundaries)
library(sf)
library(leaflet)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
# ggplot(newState)+
#   geom_sf(data = newState)+
#   geom_point(data=PopularParks, aes(x=latitude, y =longitude))
#   theme_bw()
# pal <- colorNumeric(
#   c( "maroon","steelblue", "blue4","tan","grey","red","green","orange","purple","pink"),
#   domain = min(sizePark$Total_Visitor_Spending, na.rm = TRUE):max(sizePark$Total_Visitor_Spending, na.rm = TRUE))
pal <- colorFactor(
palette = c("lightblue", "lightblue3","steelblue", "steelblue4","blue"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Latitude: ", latitude, "<br>Longitude: ", longitude,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area,),
radius = sizePark$Area/100000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )
library(USAboundaries)
library(sf)
library(leaflet)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
# ggplot(newState)+
#   geom_sf(data = newState)+
#   geom_point(data=PopularParks, aes(x=latitude, y =longitude))
#   theme_bw()
# pal <- colorNumeric(
#   c( "maroon","steelblue", "blue4","tan","grey","red","green","orange","purple","pink"),
#   domain = min(sizePark$Total_Visitor_Spending, na.rm = TRUE):max(sizePark$Total_Visitor_Spending, na.rm = TRUE))
pal <- colorFactor(
palette = c("lightblue", "lightblue3","steelblue", "steelblue4","blue"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Latitude: ", latitude, "<br>Longitude: ", longitude,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/100000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )
# addCircleMarkers(data = st_as_sf(filter(CityPop, rank==3)),group = "three",color =~pal(rank),radius = 3, fillOpacity = 0.8,label=filter(CityPop, rank==3)$city
library(USAboundaries)
library(sf)
library(leaflet)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
# ggplot(newState)+
#   geom_sf(data = newState)+
#   geom_point(data=PopularParks, aes(x=latitude, y =longitude))
#   theme_bw()
# pal <- colorNumeric(
#   c( "maroon","steelblue", "blue4","tan","grey","red","green","orange","purple","pink"),
#   domain = min(sizePark$Total_Visitor_Spending, na.rm = TRUE):max(sizePark$Total_Visitor_Spending, na.rm = TRUE))
pal <- colorFactor(
palette = c("lightblue", "lightblue3","steelblue", "steelblue4","blue"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Latitude: ", latitude, "<br>Longitude: ", longitude,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )
# addCircleMarkers(data = st_as_sf(filter(CityPop, rank==3)),group = "three",color =~pal(rank),radius = 3, fillOpacity = 0.8,label=filter(CityPop, rank==3)$city
library(USAboundaries)
library(sf)
library(leaflet)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
# ggplot(newState)+
#   geom_sf(data = newState)+
#   geom_point(data=PopularParks, aes(x=latitude, y =longitude))
#   theme_bw()
# pal <- colorNumeric(
#   c( "maroon","steelblue", "blue4","tan","grey","red","green","orange","purple","pink"),
#   domain = min(sizePark$Total_Visitor_Spending, na.rm = TRUE):max(sizePark$Total_Visitor_Spending, na.rm = TRUE))
pal <- colorFactor(
palette = c("lightblue3", "lightblue4","steelblue", "steelblue4","blue"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Latitude: ", latitude, "<br>Longitude: ", longitude,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )
# addCircleMarkers(data = st_as_sf(filter(CityPop, rank==3)),group = "three",color =~pal(rank),radius = 3, fillOpacity = 0.8,label=filter(CityPop, rank==3)$city
library(USAboundaries)
library(sf)
library(leaflet)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
pal <- colorFactor(
palette = c("lightblue3", "lightblue4","steelblue", "steelblue4","blue"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )%>%
addControl(
title = "National Parks Size and Total Visitor Spending",  # Add your title here
position = "topright"  # Adjust the position as needed
)
library(USAboundaries)
library(sf)
library(leaflet)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
pal <- colorFactor(
palette = c("lightblue3", "lightblue4","steelblue", "steelblue4","blue"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )%>%
addControl(
title = "National Parks Size and Total Visitor Spending",
position = "topright"  # Adjust the position as needed
)
library(USAboundaries)
library(sf)
library(leaflet)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
pal <- colorFactor(
palette = c("lightblue3", "lightblue4","steelblue", "steelblue4","blue"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )
library(USAboundaries)
library(sf)
library(leaflet)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
pal <- colorFactor(
palette = c("lightblue3", "lightblue4","steelblue", "steelblue4","blue"),  # Define your desired colors
domain = sizePark$Total_Visitor_Spending  # Use the variable for which you want to assign colors
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )%>%
addControl(
title = "National Parks Size and Total Visitor Spending",
position = "topright"  # Adjust the position as needed
)%>%
addControl(
title = "National Parks Size and Total Visitor Spending",
position = "topright"
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )%>%
addControl(
title = "National Parks Size and Total Visitor Spending",
position = "topright"  # Adjust the position as needed
)%>%
addControl(
title = "National Parks Size and Total Visitor Spending"
)
?addControl
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )%>%
addControl(
title = "National Parks Size and Total Visitor Spending",
position = "topright"  # Adjust the position as needed
)%>%
addControl(
className = "National Parks Size and Total Visitor Spending"
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )%>%
addControl(
title = "National Parks Size and Total Visitor Spending",
position = "topright"  # Adjust the position as needed
)%>%
addControl(
html,
className = "National Parks Size and Total Visitor Spending"
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )%>%
addControl(
title = "National Parks Size and Total Visitor Spending",
position = "topright"  # Adjust the position as needed
)%>%
addControl(
html = "title_html",
position = "topright"
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )%>%
addControl(
html = "title_html",
position = "topright"
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),  # Use the color based on Total_Visitor_Spending
fillOpacity = 0.7 )%>%
addControl(
html = "National Park Size and Total Visitor Spending",
position = "topright"
)
# Parks <- read_csv("C:/Users/hayde/Documents/School/Fall2023/CSE499/DataGathering/Data/CleanedNationalParksSpendingWeather.csv")
Parks <- read_csv("C:/Users/hayde/Documents/School/Fall2023/CSE499/DataGathering/Data/JustNationalParksSpendingWeather.csv")
annual <- read_csv("C:/Users/hayde/Documents/School/Fall2023/CSE499/DataGathering/Data/AnnualWeather.csv")
TotalParks <- Parks%>%merge(annual, by = c("Name", "year"))
PopularParks <- TotalParks%>%
filter(Name == c("Zion National Park","Yosemite National Park","Yellowstone National Park","Rocky Mountain National Park","Olympic National Park","Great Smoky Mountains National Park","Grand Teton National Park","Grand Canyon National Park","Glacier National Park","Glacier Bay National Park and Preserve","Denali National Park and Preserve"))
completedParks <- read_csv("C:/Users/hayde/Documents/School/Fall2023/CSE499/DataGathering/Data/CompletedParks.csv")
sizePark <- completedParks%>%filter(Name == c("Zion National Park","Yosemite National Park","Yellowstone National Park","Rocky Mountain National Park","Olympic National Park","Great Smoky Mountains National Park","Grand Teton National Park","Grand Canyon National Park","Glacier National Park","Glacier Bay National Park and Preserve","Denali National Park and Preserve"))
setwd("C:/Users/hayde/Documents/School/Fall2023/CSE499/NationalParksWeather")
setwd("C:/Users/hayde/Documents/School/Fall2023/CSE499/NationalParksWeather")
library(tidyverse)
library(mosaic)
library(pander)
library(ggplot2)
library(ggrepel)
library(stringr)
library(dplyr)
library(rio)
library(DT)
library(USAboundaries)
library(sf)
library(leaflet)
Parks <- read_csv("C:/Users/hayde/Documents/School/Fall2023/CSE499/DataGathering/Data/JustNationalParksSpendingWeather.csv")
annual <- read_csv("C:/Users/hayde/Documents/School/Fall2023/CSE499/DataGathering/Data/AnnualWeather.csv")
TotalParks <- Parks%>%merge(annual, by = c("Name", "year"))
PopularParks <- TotalParks%>%
filter(Name == c("Zion National Park","Yosemite National Park","Yellowstone National Park","Rocky Mountain National Park","Olympic National Park","Great Smoky Mountains National Park","Grand Teton National Park","Grand Canyon National Park","Glacier National Park","Glacier Bay National Park and Preserve","Denali National Park and Preserve"))
completedParks <- read_csv("C:/Users/hayde/Documents/School/Fall2023/CSE499/DataGathering/Data/CompletedParks.csv")
sizePark <- completedParks%>%filter(Name == c("Zion National Park","Yosemite National Park","Yellowstone National Park","Rocky Mountain National Park","Olympic National Park","Great Smoky Mountains National Park","Grand Teton National Park","Grand Canyon National Park","Glacier National Park","Glacier Bay National Park and Preserve","Denali National Park and Preserve"))
stats <- PopularParks%>%
select(Name, year, Temp_13, Total_Visitor_Spending)
datatable(stats)
custom_order <- c("Great Smoky Mountains National Park","Grand Canyon National Park","Zion National Park","Olympic National Park","Yosemite National Park","Rocky Mountain National Park","Glacier National Park","Grand Teton National Park","Yellowstone National Park","Glacier Bay National Park and Preserve","Denali National Park and Preserve")
ggplot(PopularParks, aes(x=year,y=Temp_13,color=factor(Name, levels = custom_order)))+
geom_line(size=2)+
geom_point(color="grey1",size=3)+
scale_x_continuous(breaks = c(2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022))+
labs(
title = "Temperature Over The Last Decade For 10 Popular National Parks",
x = "Year",
y = "Average Temperature",
color = "National Park Names"
)+
theme_bw()+
theme(
plot.title = element_text(hjust=.5)
)
# facet_wrap(~Name)
ggplot(TotalParks, aes(x=Temp_13,y=Total_Visitor_Spending))+
geom_point(aes(color="grey3"),alpha=.1)+
geom_point(data=TotalParks,aes(x=max_air_temp_13,y=Total_Visitor_Spending,color="maroon4"),alpha=.1)+
geom_point(data=TotalParks, aes(x=min_air_temp_13,y=Total_Visitor_Spending,color="steelblue"),alpha=.1)+
facet_wrap(~year)+
labs(
title = "Temperature at National Parks",
x = "Temperature",
y = "Total Spent at National Parks (USD)"
)+
scale_color_manual(values=c("grey3","maroon4", "steelblue"),
labels=c("Average Temperature","Max Temperature", "Min Temperature"))+
guides(
color = guide_legend(title="Legend"))+
theme_bw()+
theme(
plot.title = element_text(hjust=.5)
)
custom_order2 <- c("Great Smoky Mountains National Park","Grand Canyon National Park","Zion National Park","Grand Teton National Park","Rocky Mountain National Park","Yosemite National Park","Denali National Park and Preserve","Yellowstone National Park","Glacier National Park","Olympic National Park","Glacier Bay National Park and Preserve")
ggplot(PopularParks, aes(x=year,y=Total_Visitor_Spending,color=factor(Name, levels = custom_order2)))+
geom_line(size=1.25)+
scale_x_continuous(breaks = c(2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022))+
scale_y_continuous(breaks = c(100000,250000,500000,700000,1000000,2000000),labels = c("100,000","250,000","500,000","700,000","1,000,000","2,000,000"))+
labs(
title = "Total Visitor Spending at Popular National Parks",
x = "Year",
y = "Total Visitor Spending",
color = "National Park Names"
)+
theme_bw()+
theme(
plot.title = element_text(hjust=.5)
)
states <- us_states()
newState <- states%>%
filter(state_name != "Alaska",
state_name != "Hawaii",
state_name != "Puerto Rico")
pal <- colorFactor(
palette = c("lightblue3", "lightblue4","steelblue", "steelblue4","blue"),
domain = sizePark$Total_Visitor_Spending
)
leaflet(data = newState)%>%
addTiles()%>%
addPolylines(data=newState, color="black", weight = 1)%>%
addCircleMarkers(data = sizePark,
lng = ~longitude,
lat = ~latitude,
popup = ~paste("National Park: ", Name,"<br>Total Visitor Spending: ", Total_Visitor_Spending,"<br>Square Area: ", Area),
radius = sizePark$Area/300000,
color = ~pal(Total_Visitor_Spending),
fillOpacity = 0.7 )%>%
addControl(
html = "National Park Size and Total Visitor Spending",
position = "topright"
)
